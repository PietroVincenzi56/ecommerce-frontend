<div class="admin-dashboard">
  <h2>Dashboard Amministratore</h2>

  <!-- Sezione Utenti -->
  <section>
    <h3>Utenti Registrati</h3>
    <ul>
      <li *ngFor="let user of users">
        {{ user.name }} {{ user.surname }} - {{ user.email }} - {{ user.address }} - {{ user.telephoneNumber }}
      </li>
    </ul>
  </section>

  <!-- Sezione Gestione Prodotti -->
  <section>
    <h3>Gestione Prodotti</h3>

    <!-- Aggiunta Prodotto -->
    <h4>Aggiungi Nuovo Prodotto</h4>
    <input [(ngModel)]="newProduct.name" placeholder="Nome" />
    <input [(ngModel)]="newProduct.description" placeholder="Descrizione" />
    <input [(ngModel)]="newProduct.price" type="number" placeholder="Prezzo" />
    <input [(ngModel)]="newProduct.quantity" type="number" placeholder="Quantità" />
    <button (click)="addProduct()">Aggiungi</button>

    <!-- Lista Prodotti -->
    <h4>Prodotti esistenti</h4>
    <ul>
      <li *ngFor="let product of products">
        <!-- Vista normale -->
        <ng-container *ngIf="editingProduct?.id !== product.id; else editBlock">
          <strong>{{ product.name }}</strong> - €{{ product.price }}
          <button (click)="startEditing(product)">Modifica</button>
          <button (click)="deleteProduct(product.id)">Elimina</button>
        </ng-container>

        <!-- Modifica -->
        <ng-template #editBlock>
          <ng-container *ngIf="editingProduct as ep">
            <input [(ngModel)]="ep.name" name="name-{{product.id}}" placeholder="Nome" />
            <input [(ngModel)]="ep.description" name="desc-{{product.id}}" placeholder="Descrizione" />
            <input [(ngModel)]="ep.price" name="price-{{product.id}}" type="number" placeholder="Prezzo" />
            <input [(ngModel)]="ep.quantity" name="qty-{{product.id}}" type="number" placeholder="Quantità" />
            <button (click)="saveProduct()">Salva</button>
            <button (click)="cancelEdit()">Annulla</button>
          </ng-container>
        </ng-template>
      </li>

    </ul>
  </section>

  <!-- Sezione Ordini -->
  <section>
    <h3>Ordini Effettuati</h3>
    <ul>
      <li *ngFor="let order of orders.slice().reverse()">
        <strong>Ordine #{{ order.id }}</strong> - {{ order.time | date:'dd/MM/yyyy' }}  
        <br>
        Cliente: {{ order.buyer.name }} ({{ order.buyer.email }})
        <br>
        Prodotti:
        <ul>
          <li *ngFor="let item of order.productOrders">
            {{ item.product.name}} - Quantità: {{ item.quantity }}
          </li>
        </ul>
      </li>
    </ul>
  </section>


</div>
